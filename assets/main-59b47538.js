(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const e of document.querySelectorAll('link[rel="modulepreload"]'))s(e);new MutationObserver(e=>{for(const c of e)if(c.type==="childList")for(const r of c.addedNodes)r.tagName==="LINK"&&r.rel==="modulepreload"&&s(r)}).observe(document,{childList:!0,subtree:!0});function o(e){const c={};return e.integrity&&(c.integrity=e.integrity),e.referrerPolicy&&(c.referrerPolicy=e.referrerPolicy),e.crossOrigin==="use-credentials"?c.credentials="include":e.crossOrigin==="anonymous"?c.credentials="omit":c.credentials="same-origin",c}function s(e){if(e.ep)return;e.ep=!0;const c=o(e);fetch(e.href,c)}})();const C="https://emily-charity.onrender.com",P="Bearer sandbox_QbpEJylc3XRJ4iE8qe1axWfIGQ4k_H_bxfs3lkQt",b=async(n,t,o)=>{try{const s=await fetch(`${C}${n}`,{method:t,headers:{"Content-Type":"application/json",Authorization:P},body:o?JSON.stringify(o):void 0});if(!s.ok)throw new Error(`HTTP error! status: ${s.status}`);return await s.json()}catch(s){throw console.error(`Error with ${n}:`,s),s}},A=n=>b("/create-paypal-order","POST",{amount:n}),O=(n,t,o,s)=>b("/create-billing-request","POST",{email:n,given_name:t,family_name:o,amount:s}).then(e=>e.billing_requests.id),N=n=>b("/create-billing-request-flow","POST",{billingRequestId:n}).then(t=>t.billing_request_flows.authorisation_url);let d="",g="",k=null;window.openModal=S;function T(){window.selectAmount=D,window.continueToDetails=R,window.setPaymentMethod=$,window.handleSubmit=z,window.openModal=S,window.closeModal=p;const n=document.getElementById("payment-modal"),t=document.querySelector(".close");n&&t?(t.addEventListener("click",p),n.addEventListener("click",o=>{o.target===n&&p()})):console.error("Modal or close button element not found."),_()}function _(){const n=document.querySelector(".burger-menu"),t=document.querySelector(".mobile-nav"),o=document.querySelector(".overlay");n&&t&&o&&(n.addEventListener("click",()=>{t.classList.toggle("show"),o.classList.toggle("show")}),o.addEventListener("click",()=>{t.classList.remove("show"),o.classList.remove("show")}),window.addEventListener("resize",()=>{window.innerWidth>760&&(t.classList.remove("show"),o.classList.remove("show"))}))}function D(n){d=n,document.getElementById("custom-amount").value=d,document.querySelectorAll("#amount-selection .btn").forEach(o=>o.classList.toggle("active",o.textContent.includes(`£${n}`)))}function R(){d=document.getElementById("custom-amount").value||d,d?(document.getElementById("amount-selection").classList.add("hidden"),S()):document.getElementById("amount-message").textContent="Please select or enter an amount."}function $(n){g=n,document.querySelectorAll("#paypal, #gocardless").forEach(e=>{e.classList.toggle("active",e.id===n),e.classList.toggle("hidden",e.id!==n)});const o=document.getElementById("donation-form"),s=document.querySelector("#payment-details .title");o&&o.classList.remove("hidden"),s&&s.classList.add("hidden")}async function z(n){var u,l;n.preventDefault();const t=document.getElementById("email").value,o=document.getElementById("given-name").value,s=document.getElementById("family-name").value,e=document.getElementById("payment-message");if(d=document.getElementById("custom-amount").value||d,!o||!t){e.textContent="Please enter both your name and email.";return}const r=parseFloat(d);if(isNaN(r)||r<=0){e.textContent="Please enter a valid amount.";return}if(!g){e.textContent="Please select a payment method.";return}try{if(g==="paypal"){const m=(l=(u=(await A(r.toFixed(2))).links)==null?void 0:u.find(y=>y.rel==="approve"))==null?void 0:l.href;if(m)window.location.href=m;else throw new Error("Approval link not found in PayPal response.")}else if(g==="gocardless"){const a=await O(t,o,s,r),m=await N(a);e.innerHTML=`
        <div>
          <p>Click the link below to complete your donation of £${r}: <br>
          <a href="${m}" target="_blank" rel="noopener noreferrer" style="color: blue;" onclick="closeModal()">Complete Donation</a></p>
        </div>`}}catch(a){console.error("Error:",a.message||a),e.textContent="Error processing donation. Please try again later."}}function h(n){(n.key==="Escape"||n.target.matches(".payment-modal, .payment-modal .close"))&&p()}function S(){const n=document.getElementById("payment-modal"),t=document.getElementById("payment-message");n?(k||(k=n.cloneNode(!0)),t&&(t.textContent=""),n.style.display="block",document.getElementById("payment-details").classList.remove("hidden"),document.addEventListener("keydown",h),window.addEventListener("click",h)):console.error("Modal element not found.")}async function p(){const n=document.getElementById("payment-modal");if(n){n.style.display="none",document.body.classList.remove("no-scroll"),document.removeEventListener("keydown",h),window.removeEventListener("click",h),document.querySelectorAll("#paypal, #gocardless").forEach(r=>{r.classList.remove("hidden","active")});const o=document.getElementById("donation-form");o&&(o.reset(),o.classList.add("hidden"));const s=document.querySelector("#payment-details .title");s&&s.classList.remove("hidden");const e=document.getElementById("amount-selection");e&&e.classList.remove("hidden");const c=document.getElementById("payment-message");c&&(c.textContent=""),document.getElementById("custom-amount").value=""}else console.error("Modal element not found.")}document.querySelectorAll(".about-img img").forEach(n=>{n.addEventListener("click",function(){const t=document.createElement("img");t.src=this.src,t.classList.add("fullscreen-img"),document.body.appendChild(t),t.addEventListener("click",function(){document.body.removeChild(t)})})});document.addEventListener("DOMContentLoaded",()=>{const n=document.querySelectorAll(".count");function t(s,e){let c=0;const r=400,u=s.closest(".raised-info-each").querySelector("span").textContent.startsWith("£"),l=setInterval(()=>{c+=Math.ceil(e/r),c>=e&&(c=e,clearInterval(l)),s.textContent=u?`£ ${c.toLocaleString()}`:c.toLocaleString()},1)}function o(){const s=window.innerHeight+window.scrollY;n.forEach(e=>{if(e.getBoundingClientRect().top<s&&!e.classList.contains("animated")){const r=parseInt(e.parentElement.getAttribute("data-target"));t(e,r),e.classList.add("animated")}})}window.addEventListener("scroll",o),o()});document.addEventListener("DOMContentLoaded",()=>{const n=document.querySelector(".slides"),t=n.querySelectorAll("img"),o=document.querySelector(".prev"),s=document.querySelector(".next"),e=document.getElementById("lightbox"),c=document.querySelector(".lightbox-content"),r=document.querySelector(".lightbox .close"),u=document.querySelector(".indicators");let l=0,a;t.forEach((i,w)=>{const L=document.createElement("span");L.classList.add("dot"),L.addEventListener("click",()=>q(w)),u.appendChild(L)});const m=u.querySelectorAll(".dot");function y(){n.style.transform=`translateX(-${l*100}%)`,m.forEach(i=>i.classList.toggle("active",i.classList.contains("dot")&&i===m[l]))}function v(){l=l===0?t.length-1:l-1,y(),E()}function f(){l=l===t.length-1?0:l+1,y(),E()}function q(i){l=i,y(),E()}function B(i){l=i,e.style.display="block",c.src=t[l].src}function M(){l=l===t.length-1?0:l+1,c.src=t[l].src}function x(){l=l===0?t.length-1:l-1,c.src=t[l].src}function I(){a=setInterval(f,3e3)}function E(){clearInterval(a),I()}o.addEventListener("touchstart",v),s.addEventListener("touchstart",f),o.addEventListener("click",v),s.addEventListener("click",f),r.addEventListener("click",()=>e.style.display="none"),window.addEventListener("click",i=>{i.target===e&&(e.style.display="none")}),document.addEventListener("keydown",i=>{e.style.display==="block"?(i.key==="ArrowRight"&&M(),i.key==="ArrowLeft"&&x(),i.key==="Escape"&&(e.style.display="none")):(i.key==="ArrowLeft"&&v(),i.key==="ArrowRight"&&f())}),t.forEach((i,w)=>{i.addEventListener("click",()=>B(w))}),I()});document.addEventListener("DOMContentLoaded",()=>{const n=document.querySelectorAll("img.lazy");if("IntersectionObserver"in window){const t=new IntersectionObserver(o=>{o.forEach(s=>{if(s.isIntersecting){const e=s.target;e.src=e.dataset.src,e.classList.remove("lazy"),t.unobserve(e)}})});n.forEach(o=>t.observe(o))}else n.forEach(t=>{t.src=t.dataset.src,t.classList.remove("lazy")})});console.log("initializeDonationPage called");console.log("openModal function:",window.openModal);document.addEventListener("DOMContentLoaded",T);
//# sourceMappingURL=main-59b47538.js.map
