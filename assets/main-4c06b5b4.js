(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const e of document.querySelectorAll('link[rel="modulepreload"]'))s(e);new MutationObserver(e=>{for(const c of e)if(c.type==="childList")for(const r of c.addedNodes)r.tagName==="LINK"&&r.rel==="modulepreload"&&s(r)}).observe(document,{childList:!0,subtree:!0});function o(e){const c={};return e.integrity&&(c.integrity=e.integrity),e.referrerPolicy&&(c.referrerPolicy=e.referrerPolicy),e.crossOrigin==="use-credentials"?c.credentials="include":e.crossOrigin==="anonymous"?c.credentials="omit":c.credentials="same-origin",c}function s(e){if(e.ep)return;e.ep=!0;const c=o(e);fetch(e.href,c)}})();const A="https://emily-charity.onrender.com",O="Bearer sandbox_QbpEJylc3XRJ4iE8qe1axWfIGQ4k_H_bxfs3lkQt",S=async(n,t,o)=>{try{const s=await fetch(`${A}${n}`,{method:t,headers:{"Content-Type":"application/json",Authorization:O},body:o?JSON.stringify(o):void 0});if(!s.ok)throw new Error(`HTTP error! status: ${s.status}`);return await s.json()}catch(s){throw console.error(`Error with ${n}:`,s),s}},T=n=>S("/create-paypal-order","POST",{amount:n}),N=(n,t,o,s)=>S("/create-billing-request","POST",{email:n,given_name:t,family_name:o,amount:s}).then(e=>e.billing_requests.id),_=n=>S("/create-billing-request-flow","POST",{billingRequestId:n}).then(t=>t.billing_request_flows.authorisation_url);let u="",g="",M=null;window.openModal=I;function D(){window.selectAmount=$,window.continueToDetails=z,window.setPaymentMethod=H,window.handleSubmit=F,window.openModal=I,window.closeModal=p;const n=document.getElementById("payment-modal"),t=document.querySelector(".close");n&&t?(t.addEventListener("click",p),n.addEventListener("click",o=>{o.target===n&&p()})):console.error("Modal or close button element not found."),R()}function R(){const n=document.querySelector(".burger-menu"),t=document.querySelector(".mobile-nav"),o=document.querySelector(".overlay");n&&t&&o&&(n.addEventListener("click",()=>{t.classList.toggle("show"),o.classList.toggle("show")}),o.addEventListener("click",()=>{t.classList.remove("show"),o.classList.remove("show")}),window.addEventListener("resize",()=>{window.innerWidth>760&&(t.classList.remove("show"),o.classList.remove("show"))}))}function $(n){u=n,document.getElementById("custom-amount").value=u,document.querySelectorAll("#amount-selection .btn").forEach(o=>o.classList.toggle("active",o.textContent.includes(`£${n}`)))}function z(){u=document.getElementById("custom-amount").value||u,u?(document.getElementById("amount-selection").classList.add("hidden"),I()):document.getElementById("amount-message").textContent="Please select or enter an amount."}function H(n){g=n,document.querySelectorAll("#paypal, #gocardless").forEach(e=>{e.classList.toggle("active",e.id===n),e.classList.toggle("hidden",e.id!==n)});const o=document.getElementById("donation-form"),s=document.querySelector("#payment-details .title");o&&o.classList.remove("hidden"),s&&s.classList.add("hidden")}async function F(n){var m,l;n.preventDefault();const t=document.getElementById("email").value,o=document.getElementById("given-name").value,s=document.getElementById("family-name").value,e=document.getElementById("payment-message");if(u=document.getElementById("custom-amount").value||u,!o||!t){e.textContent="Please enter both your name and email.";return}const r=parseFloat(u);if(isNaN(r)||r<=0){e.textContent="Please enter a valid amount.";return}if(!g){e.textContent="Please select a payment method.";return}try{if(g==="paypal"){const a=(l=(m=(await T(r.toFixed(2))).links)==null?void 0:m.find(y=>y.rel==="approve"))==null?void 0:l.href;if(a)window.location.href=a;else throw new Error("Approval link not found in PayPal response.")}else if(g==="gocardless"){const d=await N(t,o,s,r),a=await _(d);e.innerHTML=`
        <div>
          <p>Click the link below to complete your donation of £${r}: <br>
          <a href="${a}" target="_blank" rel="noopener noreferrer" style="color: blue;" onclick="closeModal()">Complete Donation</a></p>
        </div>`}}catch(d){console.error("Error:",d.message||d),e.textContent="Error processing donation. Please try again later."}}function h(n){(n.key==="Escape"||n.target.matches(".payment-modal, .payment-modal .close"))&&p()}function I(){const n=document.getElementById("payment-modal"),t=document.getElementById("payment-message");n?(M||(M=n.cloneNode(!0)),t&&(t.textContent=""),n.style.display="block",document.getElementById("payment-details").classList.remove("hidden"),document.addEventListener("keydown",h),window.addEventListener("click",h)):console.error("Modal element not found.")}async function p(){const n=document.getElementById("payment-modal");if(n){n.style.display="none",document.body.classList.remove("no-scroll"),document.removeEventListener("keydown",h),window.removeEventListener("click",h),document.querySelectorAll("#paypal, #gocardless").forEach(r=>{r.classList.remove("hidden","active")});const o=document.getElementById("donation-form");o&&(o.reset(),o.classList.add("hidden"));const s=document.querySelector("#payment-details .title");s&&s.classList.remove("hidden");const e=document.getElementById("amount-selection");e&&e.classList.remove("hidden");const c=document.getElementById("payment-message");c&&(c.textContent=""),document.getElementById("custom-amount").value=""}else console.error("Modal element not found.")}document.querySelectorAll(".about-img img").forEach(n=>{n.addEventListener("click",function(){const t=document.createElement("img");t.src=this.src,t.classList.add("fullscreen-img"),document.body.appendChild(t),t.addEventListener("click",function(){document.body.removeChild(t)})})});document.addEventListener("DOMContentLoaded",()=>{const n=document.querySelectorAll(".count");function t(s,e){let c=0;const r=400,m=s.closest(".raised-info-each").querySelector("span").textContent.startsWith("£"),l=setInterval(()=>{c+=Math.ceil(e/r),c>=e&&(c=e,clearInterval(l)),s.textContent=m?`£ ${c.toLocaleString()}`:c.toLocaleString()},1)}function o(){const s=window.innerHeight+window.scrollY;n.forEach(e=>{if(e.getBoundingClientRect().top<s&&!e.classList.contains("animated")){const r=parseInt(e.parentElement.getAttribute("data-target"));t(e,r),e.classList.add("animated")}})}window.addEventListener("scroll",o),o()});document.addEventListener("DOMContentLoaded",()=>{const n=document.querySelector(".slides"),t=n.querySelectorAll("img"),o=document.querySelector(".prev"),s=document.querySelector(".next"),e=document.getElementById("lightbox"),c=document.querySelector(".lightbox-content"),r=document.querySelector(".lightbox .close"),m=document.querySelector(".indicators");let l=0,d;const a=document.createElement("div"),y=document.createElement("div");a.classList.add("lightbox-prev"),y.classList.add("lightbox-next"),a.innerHTML="&#10094;",y.innerHTML="&#10095;",e.appendChild(a),e.appendChild(y),t.forEach((i,w)=>{const b=document.createElement("span");b.classList.add("dot"),b.addEventListener("click",()=>C(w)),m.appendChild(b)});const k=m.querySelectorAll(".dot");function v(){n.style.transform=`translateX(-${l*100}%)`,k.forEach(i=>i.classList.toggle("active",i.classList.contains("dot")&&i===k[l]))}function E(){l=l===0?t.length-1:l-1,v(),L()}function f(){l=l===t.length-1?0:l+1,v(),L()}function C(i){l=i,v(),L()}function P(i){l=i,e.style.display="block",c.src=t[l].src}function x(){l=l===t.length-1?0:l+1,c.src=t[l].src}function q(){l=l===0?t.length-1:l-1,c.src=t[l].src}function B(){d=setInterval(f,3e3)}function L(){clearInterval(d),B()}o.addEventListener("touchstart",E),s.addEventListener("touchstart",f),o.addEventListener("click",E),s.addEventListener("click",f),a.addEventListener("click",q),y.addEventListener("click",x),r.addEventListener("click",()=>{e.style.display="none"}),window.addEventListener("click",i=>{i.target===e&&(e.style.display="none")}),document.addEventListener("keydown",i=>{e.style.display==="block"?(i.key==="ArrowRight"&&x(),i.key==="ArrowLeft"&&q(),i.key==="Escape"&&(e.style.display="none")):(i.key==="ArrowLeft"&&E(),i.key==="ArrowRight"&&f())}),t.forEach((i,w)=>{i.addEventListener("click",()=>P(w))}),B()});document.addEventListener("DOMContentLoaded",()=>{const n=document.querySelectorAll("img.lazy");if("IntersectionObserver"in window){const t=new IntersectionObserver(o=>{o.forEach(s=>{if(s.isIntersecting){const e=s.target;e.src=e.dataset.src,e.classList.remove("lazy"),t.unobserve(e)}})});n.forEach(o=>t.observe(o))}else n.forEach(t=>{t.src=t.dataset.src,t.classList.remove("lazy")})});console.log("initializeDonationPage called");console.log("openModal function:",window.openModal);document.addEventListener("DOMContentLoaded",D);
//# sourceMappingURL=main-4c06b5b4.js.map
